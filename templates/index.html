<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RPTPV2</title>
    <script src="https://cdn.jsdelivr.net/npm/appwrite@13.0.0"></script>
    <script src="redirect.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="map"></div>

    <!-- Settings Button -->
    <div class="leaflet-control-container">
        <div class="leaflet-top leaflet-right">
            <div class="leaflet-control">
                <button id="settings-btn" class="settings-button">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-settings"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>
                </button>
            </div>
        </div>
    </div>

    <div id="panel">
        <!-- Main Panel View -->
        <div id="panel-main-view">
            <div class="panel-header">
                <div class="panel-header-main">
                    <h2>Riyadh Public Transport Planner (V2)</h2>
                    <button id="alerts-btn" class="header-icon-button" aria-label="Show alerts">
                        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path><path d="M13.73 21a2 2 0 0 1-3.46 0"></path></svg>
                        <span id="alerts-notification-dot" class="notification-dot hidden"></span>
                    </button>
                </div>
                <nav class="tab-nav">
                    <button id="route-tab" class="tab-button active">Route</button>
                    <button id="stations-tab" class="tab-button">Stations</button>
                    <button id="lines-tab" class="tab-button">Lines</button>
                </nav>
            </div>
            <div class="panel-content">
                <div id="route-content" class="tab-pane active">
                    <form id="route-form">
                        <div class="input-group">
                            <label for="start-input">Start</label>
                            <input type="text" id="start-input" placeholder="Finding your location...">
                        </div>
                        <div class="input-group">
                            <label for="end-input">End</label>
                            <input type="text" id="end-input" placeholder="Enter destination">
                        </div>
                        <button type="submit" class="button-with-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M19 12H5M12 19l-7-7 7-7"></path></svg>
                            <span>Find Route</span>
                        </button>
                        <button type="button" id="use-my-location" class="secondary-button button-with-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle></svg>
                            <span>Use My Location</span>
                        </button>
                    </form>
                    <div id="route-details"></div>
                </div>
                <div id="stations-content" class="tab-pane">
                    <div id="stations-list" class="stations-list"></div>
                </div>
                <div id="lines-content" class="tab-pane">
                    <div class="search-container">
                        <input type="text" id="line-search-input" placeholder="Search for a line (e.g., 'BRT11', 'KAFD')...">
                    </div>
                    <div id="lines-list" class="lines-list"></div>
                </div>
            </div>
        </div>

        <!-- Station Detail View (hidden by default) -->
        <div id="station-detail-view" class="hidden">
            <div class="panel-header">
                <button id="station-detail-back-btn" class="back-button">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M19 12H5M12 19l-7-7 7-7"></path></svg>
                </button>
                <h3 id="station-detail-name">Station Name</h3>
            </div>
            <div id="station-detail-content" class="panel-content">
                <!-- Content will be populated by JS -->
            </div>
        </div>

        <!-- NEW: Line Detail View (hidden by default) -->
        <div id="line-detail-view" class="hidden">
            <div class="panel-header">
                <button id="line-detail-back-btn" class="back-button">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M19 12H5M12 19l-7-7 7-7"></path></svg>
                </button>
                <h3 id="line-detail-name">Line Name</h3>
            </div>
            <div id="line-detail-content" class="panel-content">
                <!-- Stations for the line will be populated by JS -->
            </div>
        </div>

        <!-- NEW: Direction Selection View (hidden by default) -->
        <div id="direction-selection-view" class="hidden">
            <div class="panel-header">
                <button id="direction-selection-back-btn" class="back-button">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M19 12H5M12 19l-7-7 7-7"></path></svg>
                </button>
                <h3>Select Direction</h3>
            </div>
            <div id="direction-selection-content" class="panel-content">
                <!-- Direction options will be populated by JS -->
            </div>
        </div>
    </div>


    <!-- Settings Menu Overlay -->
    <div id="settings-overlay" class="settings-overlay">
        <div class="settings-panel">
            <h3>Settings</h3>
            <div class="settings-group">
                <label for="language-select">Language</label>
                <select id="language-select">
                    <option value="en">English</option>
                    <option value="ar">Arabic (العربية)</option>
                </select>
            </div>
            <div class="settings-group">
                <label for="layout-select">Layout</label>
                <select id="layout-select">
                    <option value="desktop" selected>Desktop</option>
                    <option value="mobile">Mobile</option>
                    <option value="legacy">Legacy</option>
                </select>
            </div>
            <div class="settings-info">
                <p>Welcome to the second release of RPTP (This name could change in the future). This is a project that plans on making transporting in Riyadh easier. Keep in mind this is an early release and some things might not work as intended, if you find an issue please report it on the GitHub page.</p>
            </div>
            <button id="settings-close-btn" class="settings-close-button">Close</button>
        </div>
    </div>

    <!-- NEW: Alerts Menu Overlay -->
    <div id="alerts-overlay" class="settings-overlay">
        <div class="settings-panel">
            <h3>Current Alerts</h3>
            <div id="alerts-content" class="alerts-content">
                <!-- Alerts will be populated by JS -->
                <p>No active alerts.</p>
            </div>
            <button id="alerts-close-btn" class="settings-close-button">Close</button>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="app.js"></script>
</body>
</html>
