<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RPTPV2</title>
    <script src="https://cdn.jsdelivr.net/npm/appwrite@13.0.0"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link href="https://cdn.maptiler.com/maptiler-sdk-js/v3.8.0/maptiler-sdk.css" rel="stylesheet" />
    <link rel="stylesheet" href="mobile.css">
</head>
<body>
    <div id="map"></div>

    <!-- Map Buttons -->
    <div class="leaflet-control-container">
        <div class="leaflet-top leaflet-right">
            <div class="leaflet-control map-buttons-container">
                <button id="alerts-btn" class="map-button">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path><path d="M13.73 21a2 2 0 0 1-3.46 0"></path></svg>
                    <span id="alerts-notification-dot" class="notification-dot hidden"></span>
                </button>
                <button id="settings-btn" class="map-button">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>
                </button>
            </div>
        </div>
    </div>

    <div id="panel" class="panel">
        <div id="panel-handle" class="panel-handle"><div class="grabber"></div></div>
        <div id="panel-content" class="panel-content">
            <!-- Main View with Tabs -->
            <div id="panel-main-view">
                <nav class="tab-nav">
                    <button id="route-tab" class="tab-button active">Route</button>
                    <button id="stations-tab" class="tab-button">Stations</button>
                    <button id="lines-tab" class="tab-button">Lines</button> <!-- NEW -->
                </nav>
                <div id="tab-content">
                    <div id="route-content" class="tab-pane active">
                        <div class="form-container">
                            <form id="route-form">
                                <div class="input-group"><input type="text" id="start-input" placeholder="Finding your location..."></div>
                                <div class="input-group"><input type="text" id="end-input" placeholder="Enter destination"></div>
                                <button type="submit" class="button-with-icon">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M19 12H5M12 19l-7-7 7-7"></path></svg>
                                    <span>Find Route</span>
                                </button>
                                <button type="button" id="use-my-location" class="secondary-button button-with-icon">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle></svg>
                                    <span>Use My Location</span>
                                </button>
                            </form>
                        </div>
                        <div id="route-details"></div>
                    </div>
                    <div id="stations-content" class="tab-pane">
                        <div id="stations-list" class="stations-list"></div>
                    </div>
                    <!-- NEW Lines Tab Content -->
                    <div id="lines-content" class="tab-pane">
                        <div class="search-container">
                            <input type="text" id="line-search-input" placeholder="Search for a line (e.g., 'BRT11', 'KAFD')...">
                        </div>
                        <div id="lines-list" class="lines-list"></div>
                    </div>
                </div>
            </div>
            <!-- Station Detail View -->
            <div id="station-detail-view" class="hidden">
                 <div class="detail-header">
                    <button id="station-detail-back-btn" class="back-button">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M19 12H5M12 19l-7-7 7-7"></path></svg>
                    </button>
                    <h3 id="station-detail-name">Station Name</h3>
                </div>
                <div id="station-detail-content" class="detail-content"></div>
            </div>
            <!-- NEW Line Detail View -->
            <div id="line-detail-view" class="hidden">
                <div class="detail-header">
                   <button id="line-detail-back-btn" class="back-button">
                       <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M19 12H5M12 19l-7-7 7-7"></path></svg>
                   </button>
                   <div id="line-detail-name" class="line-detail-title-container"></div>
               </div>
               <div id="line-detail-content" class="detail-content"></div>
           </div>
        </div>
    </div>

    <!-- Location Selection Overlay -->
    <div id="location-overlay" class="bottom-overlay">
        <div class="bottom-panel">
            <p>Set this location as...</p>
            <button id="overlay-set-origin" class="bottom-panel-button">Origin</button>
            <button id="overlay-set-destination" class="bottom-panel-button">Destination</button>
            <button id="overlay-set-stations" class="bottom-panel-button">Stations Nearby</button>
            <button id="overlay-cancel" class="bottom-panel-button cancel">Cancel</button>
        </div>
    </div>

    <!-- NEW Direction Selection Overlay -->
    <div id="direction-overlay" class="bottom-overlay">
        <div id="direction-panel" class="bottom-panel">
            <p>Select Direction</p>
            <!-- Options will be populated by JS -->
            <button id="direction-cancel" class="bottom-panel-button cancel">Cancel</button>
        </div>
    </div>

    <!-- NEW Alerts Overlay -->
    <div id="alerts-overlay" class="bottom-overlay">
        <div class="bottom-panel">
            <h3>Current Alerts</h3>
            <div id="alerts-content" class="alerts-content">
                <!-- Alerts will be populated by JS -->
                <p>No active alerts.</p>
            </div>
            <button id="alerts-close-btn" class="bottom-panel-button cancel">Close</button>
        </div>
    </div>

    <!-- Settings Menu Overlay -->
    <div id="settings-overlay" class="bottom-overlay">
        <div class="settings-panel">
            <h3>Settings</h3>
            <div class="settings-group">
                <label for="language-select">Language</label>
                <select id="language-select">
                    <option value="en">English</option>
                    <option value="ar">Arabic (العربية)</option>
                </select>
            </div>
            <div class="settings-group">
                <label for="layout-select">Layout</label>
                <select id="layout-select">
                    <option value="desktop">Desktop</option>
                    <option value="mobile" selected>Mobile</option>
                    <option value="legacy">Legacy</option>
                </select>
            </div>
            <div class="settings-info">
                <p>Welcome to the second release of RPTP (This name could change in the future). This is a project that plans on making transporting in Riyadh easier. Keep in mind this is an early release and some things might not work as intended, if you find an issue please report it on the GitHub page.</p>
            </div>
            <button id="settings-close-btn" class="settings-close-button">Close</button>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <script src="https://cdn.maptiler.com/maptiler-sdk-js/v3.8.0/maptiler-sdk.umd.min.js"></script>
    <script src="https://cdn.maptiler.com/leaflet-maptilersdk/v4.1.0/leaflet-maptilersdk.umd.min.js"></script>

    <script src="mobile.js"></script>
</body>
</html>
