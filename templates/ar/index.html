<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RPTPV2</title>
    <script src="https://cdn.jsdelivr.net/npm/appwrite@13.0.0"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link href="https://cdn.maptiler.com/maptiler-sdk-js/v3.8.0/maptiler-sdk.css" rel="stylesheet" />
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Almarai:wght@300;400;700;800&display=swap" rel="stylesheet">
</head>
<body>
    <div id="map"></div>

    <div class="leaflet-control-container">
        <div class="leaflet-top leaflet-left">
            <div class="leaflet-control">
                <button id="settings-btn" class="settings-button">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06-.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>
                </button>
            </div>
        </div>
    </div>

    <div id="panel">
        <div id="panel-main-view">
            <div class="panel-header">
                <div class="panel-header-main">
                    <h2>مخطط النقل العام (V2)</h2>
                    <button id="alerts-btn" class="header-icon-button" aria-label="إظهار التنبيهات">
                        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path><path d="M13.73 21a2 2 0 0 1-3.46 0"></path></svg>
                        <span id="alerts-notification-dot" class="notification-dot hidden"></span>
                    </button>
                </div>
                <nav class="tab-nav">
                    <button id="route-tab" class="tab-button active">البحث عن مسار</button>
                    <button id="stations-tab" class="tab-button">محطات</button>
                    <button id="lines-tab" class="tab-button">المسارات</button>
                </nav>
            </div>
            <div class="panel-content">
                <div id="route-content" class="tab-pane active">
                    <form id="route-form">
                        <div class="input-group">
                            <label for="start-input">مكان المغادرة</label>
                            <input type="text" id="start-input" placeholder="جاري البحث على موقعك...">
                        </div>
                        <div class="input-group">
                            <label for="end-input">مكان الوصول</label>
                            <input type="text" id="end-input" placeholder="أدخل وجهتك">
                        </div>
                        <button type="submit" class="button-with-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></svg>
                            <span>أبحث عن طريق</span>
                        </button>
                        <button type="button" id="use-my-location" class="secondary-button button-with-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle></svg>
                            <span>إستخدم موقعي</span>
                        </button>
                    </form>
                    <div id="route-details"></div>
                </div>
                <div id="stations-content" class="tab-pane">
                    <div id="stations-list" class="stations-list"></div>
                </div>
                <div id="lines-content" class="tab-pane">
                    <div class="search-container">
                        <input type="text" id="line-search-input" placeholder="ابحث عن مسار (مثل 'BRT11' ، 'النسيم')...">
                    </div>
                    <div id="lines-list" class="lines-list"></div>
                </div>
            </div>
        </div>

        <div id="station-detail-view" class="hidden">
            <div class="panel-header">
                <button id="station-detail-back-btn" class="back-button">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14M12 5l7 7-7 7"></path></svg>
                </button>
                <h3 id="station-detail-name">إسم المحطة</h3>
            </div>
            <div id="station-detail-content" class="panel-content">
                </div>
        </div>

        <div id="line-detail-view" class="hidden">
            <div class="panel-header">
                <button id="line-detail-back-btn" class="back-button">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14M12 5l7 7-7 7"></path></svg>
                </button>
                <h3 id="line-detail-name">اسم المسار</h3>
            </div>
            <div id="line-detail-content" class="panel-content">
                </div>
        </div>

        <div id="direction-selection-view" class="hidden">
            <div class="panel-header">
                <button id="direction-selection-back-btn" class="back-button">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14M12 5l7 7-7 7"></path></svg>
                </button>
                <h3>اختر الاتجاه</h3>
            </div>
            <div id="direction-selection-content" class="panel-content">
                </div>
        </div>
    </div>


    <div id="settings-overlay" class="settings-overlay">
        <div class="settings-panel">
            <h3>الإعدادات</h3>
            <div class="settings-group">
                <label for="language-select">اللغة</label>
                <select id="language-select">
                    <option value="en">إنجليزية (English)</option>
                    <option value="ar" selected>العربية</option>
                </select>
            </div>
            <div class="settings-group">
                <label for="layout-select">النمط</label>
                <select id="layout-select">
                    <option value="desktop" selected>حاسوب</option>
                    <option value="mobile">هاتف</option>
                </select>
            </div>
            <div class="settings-info">
                <p>السلام عليكم ورحمة الله وبراكاته
                مرحبًا بكم في الإصدار الثاني من RPTP. هذا مشروع يهدف إلى تسهيل التنقل في الرياض. يرجى ملاحظة أن هذا إصدار مبكر، لذا لا ننصح بالاعتماد عليه بشكل كامل حاليا.'</p>
            </div>
            <button id="settings-close-btn" class="settings-close-button">إغلاق</button>
        </div>
    </div>

    <div id="alerts-overlay" class="settings-overlay">
        <div class="settings-panel">
            <h3>التنبيهات الحالية</h3>
            <div id="alerts-content" class="alerts-content">
                <p>لا توجد تنبيهات نشطة.</p>
            </div>
            <button id="alerts-close-btn" class="settings-close-button">إغلاق</button>
        </div>
    </div>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdn.maptiler.com/maptiler-sdk-js/v3.8.0/maptiler-sdk.umd.min.js"></script>
    <script src="https://cdn.maptiler.com/leaflet-maptilersdk/v4.1.0/leaflet-maptilersdk.umd.min.js"></script>
    <script src="redirect.js"></script>
    <script src="app.js"></script>
</body>
</html>
